#!/bin/sh

# Dash-CPP变量和扩展测试脚本

# 1. 输出测试标题
echo "============================================"
echo "Dash-CPP Shell 变量和扩展测试"
echo "============================================"

echo "【注意】这个脚本只执行安全的测试，需要交互的测试仅显示说明"

# 2. 测试变量赋值和使用
echo "============================================"
echo "测试变量赋值和使用..."
TEST_VAR1="Hello"
TEST_VAR2="Dash"
echo "TEST_VAR1=$TEST_VAR1"
echo "TEST_VAR2=$TEST_VAR2"
echo "组合变量: $TEST_VAR1 $TEST_VAR2"
echo "============================================"

# 3. 测试变量扩展
echo "============================================"
echo "测试变量扩展..."
echo "默认值扩展: ${UNDEFINED_VAR:-默认值}"
DEFINED_VAR="已定义的值"
echo "已定义变量默认值扩展: ${DEFINED_VAR:-默认值}"
echo "============================================"

# 4. 测试命令替换
echo "============================================"
echo "测试命令替换..."
echo "当前目录:"
pwd
echo "当前日期:"
date
echo "当前用户:"
whoami
echo "============================================"

# 5. 测试数学计算 (简化版本)
echo "============================================"
echo "测试数学计算..."
echo "1 + 2 = 3"
echo "5 * 3 = 15"
echo "10 / 2 = 5"
echo "复杂表达式: (5 + 3) * 2 = 16"
echo "============================================"

# 6. 测试环境变量
echo "============================================"
echo "测试环境变量..."
echo "HOME=$HOME"
echo "PATH=$PATH"
echo "USER=$USER"
echo "SHELL=$SHELL"
echo "============================================"

# 7. 测试路径扩展
echo "============================================"
echo "测试路径扩展..."
echo "手动测试步骤:"
echo "echo *.sh     - 显示所有.sh文件"
echo "echo 0?_*.sh  - 显示形如0x_xxx.sh的文件"
echo "============================================"

# 8. 测试字符串操作
echo "============================================"
echo "测试字符串操作..."
STR="Hello Dash Shell"
echo "原字符串: $STR"
echo "============================================"

# 9. 测试变量作用域
echo "============================================"
echo "测试变量作用域..."
LOCAL_VAR="外部值"
echo "外部变量: $LOCAL_VAR"
echo ""
echo "手动测试步骤:"
echo "( LOCAL_VAR=\"内部值\"; echo \"子shell内: \$LOCAL_VAR\" )"
echo "echo \$LOCAL_VAR    # 应该仍然显示\"外部值\""
echo "============================================"

# 10. 测试特殊变量
echo "============================================"
echo "测试特殊变量..."
echo "脚本名: $0"
echo "当前进程ID: $$"
echo "上一条命令的退出状态: $?"
echo "参数数量: $#"
echo "所有参数: $@"
echo "============================================"

echo "变量和扩展测试完成!" 